clear;

Gmatrix_DSS = [0.986365048	-0.33982947	-0.070927402	-0.214448072	-0.176796371	-0.986365048	0.33982947	0.070927402	0.214448072	0.176796371;
-0.33982947	1.136504083	-0.33982947	-0.179486387	-0.179486387	0.33982947	-1.136504083	0.33982947	0.179486387	0.179486387;
-0.070927402	-0.33982947	0.986365048	-0.176796371	-0.214448072	0.070927402	0.33982947	-0.986365048	0.176796371	0.214448072;
-0.214448072	-0.179486387	-0.176796371	0.964821043	-0.042634799	0.214448072	0.179486387	0.176796371	-0.964821043	0.042634799;
-0.176796371	-0.179486387	-0.214448072	-0.042634799	0.964821043	0.176796371	0.179486387	0.214448072	0.042634799	-0.964821043;
-0.986365048	0.33982947	0.070927402	0.214448072	0.176796371	0.986365048	-0.33982947	-0.070927402	-0.214448072	-0.176796371;
0.33982947	-1.136504083	0.33982947	0.179486387	0.179486387	-0.33982947	1.136504083	-0.33982947	-0.179486387	-0.179486387;
0.070927402	0.33982947	-0.986365048	0.176796371	0.214448072	-0.070927402	-0.33982947	0.986365048	-0.176796371	-0.214448072;
0.214448072	0.179486387	0.176796371	-0.964821043	0.042634799	-0.214448072	-0.179486387	-0.176796371	0.964821043	-0.042634799;
0.176796371	0.179486387	0.214448072	0.042634799	-0.964821043	-0.176796371	-0.179486387	-0.214448072	-0.042634799	0.964821043];

Bmatrix_DSS = [-4.777029515	1.753519253	1.113457109	0.078182917	0.075610658	4.777030458	-1.753519505	-1.11345719	-0.078182985	-0.075610701;
1.753519253	-5.169029772	1.753519253	0.073935479	0.073935479	-1.753519505	5.169030779	-1.753519505	-0.07393553	-0.07393553;
1.113457109	1.753519253	-4.777029515	0.075610658	0.078182917	-1.11345719	-1.753519505	4.777030458	-0.075610701	-0.078182985;
0.078182917	0.073935479	0.075610658	-0.300793201	-0.049298769	-0.078182985	-0.07393553	-0.075610701	0.300793687	0.049298685;
0.075610658	0.073935479	0.078182917	-0.049298769	-0.300793201	-0.075610701	-0.07393553	-0.078182985	0.049298685	0.300793687;
4.777030458	-1.753519505	-1.11345719	-0.078182985	-0.075610701	-4.777029515	1.753519253	1.113457109	0.078182917	0.075610658;
-1.753519505	5.169030779	-1.753519505	-0.07393553	-0.07393553	1.753519253	-5.169029772	1.753519253	0.073935479	0.073935479;
-1.11345719	-1.753519505	4.777030458	-0.075610701	-0.078182985	1.113457109	1.753519253	-4.777029515	0.075610658	0.078182917;
-0.078182985	-0.07393553	-0.075610701	0.300793687	0.049298685	0.078182917	0.073935479	0.075610658	-0.300793201	-0.049298769;
-0.075610701	-0.07393553	-0.078182985	0.049298685	0.300793687	0.075610658	0.073935479	0.078182917	-0.049298769	-0.300793201];

Ymatrix_DSS=complex(Gmatrix_DSS, Bmatrix_DSS);

Y11 = Ymatrix_DSS(1:5,1:5);
Y12 = Ymatrix_DSS(1:5,6:10);
Y21 = Ymatrix_DSS(6:10, 1:5);
Y22 = Ymatrix_DSS(6:10, 1:5);

A_DSS = -Y22/Y21;
B_DSS = inv(Y21);
C_DSS = (Y12*Y21-Y11*Y22)/Y21;
D_DSS = -Y11/Y21;

Tmatrix_DSS = [A_DSS B_DSS; C_DSS D_DSS]

##Zmatrix_DSS = inv(Ymatrix)

Tmatrix_XGS = [-0.999999828462101-3.13670236348603E-08i	4.04045499108485E-08-4.88074059269599E-09i	3.96688349033535E-08-7.83819886997219E-09i	3.6061617188303E-08+4.37701607442529E-08i	3.5609932492534E-08+2.59573943484604E-08i	-1.57651669496772E-14+1.47661397242871E-06i	-6.10622663543836E-16-3.20681039278625E-07i	-6.24500451351651E-15-1.19995070546608E-07i	2.12607709215717E-14-1.13761670472723E-07i	1.07136521876328E-14-7.56321711925523E-08i;
3.4508297744164E-08-3.41364632142324E-09i	-0.999999834619762-3.08546257160819E-08i	3.45082977540252E-08-3.41364632346514E-09i	3.06266791171369E-08+3.48783569286457E-08i	3.06266790487863E-08+3.48783569378278E-08i	-7.21644966006352E-16-3.20681039056581E-07i	-1.55431223447522E-14+1.54139736974201E-06i	-7.21644966006352E-16-3.20681039056581E-07i	1.55708779203678E-14-9.16636222203504E-08i	1.56541446472147E-14-9.16636222619838E-08i;
3.96688350233087E-08-7.838198860215E-09i	4.04045500763833E-08-4.88074058309073E-09i	-0.999999828462101-3.13670236169573E-08i	3.56099325484501E-08+2.5957394361489E-08i	3.60616172347436E-08+4.3770160759392E-08i	-6.30051566474776E-15-1.19995070324563E-07i	-7.21644966006352E-16-3.20681038834536E-07i	-1.58761892521397E-14+1.47661397154053E-06i	1.07136521876328E-14-7.56321712064301E-08i	2.13440376484186E-14-1.13761670472723E-07i;
2.01819640824394E-08-3.9376889951149E-09i	2.0061475547603E-08-4.26334230262923E-09i	1.98685984498761E-08-4.49959354021525E-09i	-0.999999850580132-4.58299547156301E-07i	1.79436796645495E-08+7.46623195058635E-08i	2.12885264971874E-14-1.13761670486601E-07i	1.56541446472147E-14-9.1663622248106E-08i	1.05748743095546E-14-7.56321711786745E-08i	-1.53210777398272E-13+9.6930749332591E-07i	7.60710938685349E-14-1.71535436889469E-07i;
1.98685984470481E-08-4.49959356579877E-09i	2.00614755571649E-08-4.26334230418934E-09i	2.0181964099919E-08-3.93768899431546E-09i	1.79436796532428E-08+7.46623195074791E-08i	-0.999999850580132-4.58299547145824E-07i	1.06858966120171E-14-7.56321712064301E-08i	1.56263890715991E-14-9.1663622248106E-08i	2.12330153459561E-14-1.13761670417212E-07i	7.60919105502467E-14-1.71535436903347E-07i	-1.53321799700734E-13+9.6930749332591E-07i;
-0.0520471584926494-0.28858850982191i	-0.0225736658857041-0.144214108130358i	-0.0225736658857041-0.123257019597276i	-0.0220273680092038-0.118697464779773i	-0.0220273680092039-0.112622361926506i	0.999999828462101+3.13670236451458E-08i	-3.45082977609712E-08+3.4136463482326E-09i	-3.96688348588796E-08+7.8381988573295E-09i	-2.01819640992685E-08+3.9376890068922E-09i	-1.98685984340377E-08+4.49959355923934E-09i;
-0.0225736658857041-0.144214108130358i	-0.0520471581683253-0.288588508951926i	-0.022573665885704-0.144214108130358i	-0.0220273680092038-0.117689352140807i	-0.0220273680092038-0.117689352140807i	-4.04045497840594E-08+4.88074057038157E-09i	0.999999834619762+3.08546256877484E-08i	-4.04045498482442E-08+4.88074059813715E-09i	-2.00614755389503E-08+4.2633423388296E-09i	-2.00614755519607E-08+4.26334232874652E-09i;
-0.0225736658857041-0.123257019597276i	-0.0225736658857041-0.144214108130358i	-0.0520471584926494-0.28858850982191i	-0.0220273680092038-0.112622361926506i	-0.0220273680092038-0.118697464779773i	-3.96688348484713E-08+7.83819883651282E-09i	-3.45082979144942E-08+3.41364633782426E-09i	0.999999828462101+3.13670235896346E-08i	-1.98685984565891E-08+4.4995935944217E-09i	-2.01819640847402E-08+3.93768901128322E-09i;
-0.0220273680092039-0.118697464779773i	-0.0220273680092038-0.117689352140807i	-0.0220273680092038-0.112622361926506i	-0.955810957067106-0.366115539702764i	-0.0214810701327036-0.135422898064719i	-3.60616171646289E-08-4.37701607805541E-08i	-3.06266790262022E-08-3.48783568832056E-08i	-3.56099326970227E-08-2.59573944005886E-08i	0.999999850580132+4.58299547201335E-07i	-1.79436796601817E-08-7.4662319514418E-08i;
-0.0220273680092039-0.112622361926506i	-0.0220273680092038-0.117689352140807i	-0.0220273680092038-0.118697464779773i	-0.0214810701327036-0.135422898064719i	-0.955810957067106-0.366115539702764i	-3.5609932419467E-08-2.59573943589553E-08i	-3.06266790817133E-08-3.4878356924839E-08i	-3.606161722014E-08-4.37701607527985E-08i	-1.79436796601817E-08-7.46623194866625E-08i	0.999999850580132+4.58299547145824E-07i]

indicator = ((Tmatrix_XGS-Tmatrix_DSS)/Tmatrix_XGS)

mean(indicator, "all")*100



##A = Tmatrix(1:5,1:5);
##B = Tmatrix(1:5,6:10);
##C= Tmatrix(6:10, 1:5);
##D = Tmatrix(6:10, 1:5);
##A_inv = inv(A);
##B_inv = inv(B);
##C_inv = inv(C);
##D_inv = inv(D);

##Z1 = dot(A, C_inv)
##Z2 = dot(Z1, D) - B
##Z3 = C_inv
##Z4 = dot(C_inv, D)

##Z1 = A*C_inv;
##Z2 = A*C_inv*D-B;
##Z3 = C_inv;
##Z4 = C_inv*D;
##
##
##Zmatrix_XGS =  [Z1, Z2; Z3, Z4];



